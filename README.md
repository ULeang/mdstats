# MD stats

MD stats是一个基于图像识别模板匹配的MD对局自动统计工具

## 安装方式

TODO

## 使用方式

在根目录下打开mdstats.exe程序，此时会出现一个黑色的输出窗口和一个程序窗口。黑色的输出窗口中是程序的日志信息，一般不用关注；程序窗口主要分为统计表格以及记录表格。
打开MD客户端，然后点击程序窗口中的绿色`启动`按钮，该按钮变灰，`停止`按钮变红，代表程序已经开始运行，进行对战即可，此时点击红色`停止`按钮，程序会停止。

在程序正常运行中，会按照`识别硬币`-`识别先后攻`-`识别对局结果`的顺序不断循环，如果前一步没有识别到，不会识别后一步，所以请在对局开始前就点击`启动`。
注意，由于程序默认情况下每间隔0.5秒进行一次窗口捕获并进行匹配，如果太早退出对局结果界面，会导致程序无法识别对局结果，进而卡在`识别对局结果`这一步；在各种程序没有正常识别结果的情况下，可以手动点击统计表格下方的两个青蓝色按钮，手动提交结果。
程序目前不支持识别平局结果，也不支持识别丢完硬币拔线，如果遇到这类特殊情况，请手动点击`停止`按钮并再次点击`启动`按钮重新启动程序。

程序会从根目录下的`resource/csv/data.csv`文件读取对局记录，尽量不要手动修改这个文件，直接在程序内的记录表格修改即可。程序内有一个按钮`打开data.csv目录`可以打开这个文件，请使用使用记事本或者vscode之类的文本编辑器进行编辑并保存为utf-8或utf-16编码，否则读取文件会失败。
如果手动修改了`data.csv`文件，请点击程序窗口中的`重新加载数据`按钮以重新加载对局记录。
如果该文件损坏，程序内记录表格会出现警告，此时程序内的任何记录都不会被保存，不要在这个情况下进行记录，务必先修复该文件消除警告！

点击`复制到剪贴板`按钮，可以把统计表格中的内容复制到剪贴板。

## 配置方式

根目录下`config.toml`文件是本程序的配置文件，可以使用文本编辑器如记事本打开，在其中配置一些程序的行为，如统计表格的颜色、匹配的间隔时间等等。

## 其他

本程序目前尚未支持一些低分辨率，如果遇到这种情况，点击`启动`按钮时会无法启动程序，同时在黑色输出窗口中打印日志，请参照该窗口。
